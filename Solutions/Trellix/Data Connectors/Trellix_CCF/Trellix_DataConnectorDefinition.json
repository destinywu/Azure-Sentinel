{
  "name": "TrellixConnector",
  "apiVersion": "2025-07-01-preview",
  "type": "Microsoft.SecurityInsights/dataConnectorDefinitions",
  "location": "{{location}}",
  "kind": "Customizable",
  "properties": {
    "connectorUiConfig": {
      "id": "TrellixConnector",
      "title": "Trellix Endpoint Security (via Codeless Connector Framework)",
      "publisher": "Microsoft",
      "descriptionMarkdown": "The [Trellix Endpoint Security](https://www.trellix.com/) data connector enables you to ingest security events from Trellix ePO (ePolicy Orchestrator) into Microsoft Sentinel. This connector uses OAuth2 client credentials authentication and automatically handles pagination to collect comprehensive endpoint security data including threat detections, analyzer information, source and target system details, and threat response actions.",
      "graphQueriesTableName": "TrellixEvents",
      "graphQueries": [
        {
          "metricName": "Trellix events",
          "legend": "Trellix ePO Events",
          "baseQuery": "TrellixEvents"
        }
      ],
      "sampleQueries": [
        {
          "description": "All Trellix events",
          "query": "{{graphQueriesTableName}}\n| sort by TimeGenerated desc"
        }
      ],
      "dataTypes": [
        {
          "name": "TrellixEvents",
          "lastDataReceivedQuery": "TrellixEvents\n| where TimeGenerated > ago(6h)\n| summarize Time = max(TimeGenerated)\n| where isnotempty(Time)"
        }
      ],
      "connectivityCriteria": [
        {
          "type": "HasDataConnectors"
        },
        {
          "type": "IsConnectedQuery",
          "value": [
            "TrellixEvents | where TimeGenerated > ago(1h) | take 1"
          ]
        }
      ],
      "availability": {
        "isPreview": true,
        "status": 1
      },
      "permissions": {
        "resourceProvider": [
          {
            "provider": "Microsoft.OperationalInsights/workspaces",
            "permissionsDisplayText": "Read and Write permissions are required.",
            "providerDisplayName": "Workspace",
            "scope": "Workspace",
            "requiredPermissions": {
              "write": true,
              "read": true,
              "delete": true,
              "action": false
            }
          }
        ]
      },
      "instructionSteps": [
        {
          "title": "1. API Configuration",
          "description": "Configure your Trellix ePO API connection.",
          "instructions": [
            {
              "type": "Textbox",
              "parameters": {
                "label": "API Base URL",
                "placeholder": "https://api.manage.trellix.com",
                "type": "text",
                "name": "trellixApiBaseUrl",
                "validations": {
                  "required": true
                }
              }
            },
            {
              "type": "Markdown",
              "parameters": {
                "content": "## Authentication\n\nProvide your API key for authentication. This will be sent in the x-api-key header."
              }
            },
            {
              "type": "Textbox",
              "parameters": {
                "label": "API Key",
                "placeholder": "Enter your API key",
                "type": "password",
                "name": "apiKey",
                "validations": {
                  "required": true
                }
              }
            },
            {
              "type": "InfoMessage",
              "parameters": {
                "text": "The API key will be securely stored and used for authentication with the Trellix ePO API.",
                "visible": true,
                "inline": true
              }
            }
          ]
        },
        {
          "title": "2. Authentication Configuration",
          "description": "Configure OAuth2 authentication credentials.",
          "instructions": [
            {
              "type": "Textbox",
              "parameters": {
                "label": "Token endpoint",
                "placeholder": "https://iam.cloud.trellix.com/iam/v1.0/token",
                "type": "text",
                "name": "trellixAuthTokenUrl",
                "validations": {
                  "required": true
                }
              }
            },
            {
              "type": "Markdown",
              "parameters": {
                "content": "### OAuth2 Configuration\nConfigure OAuth2 client credentials for API access. Read about the Trellix API authorization model at https://developer.manage.trellix.com/public/mvision/docs/umam"
              }
            },
            {
              "type": "Textbox",
              "parameters": {
                "label": "Client ID",
                "placeholder": "Your client ID",
                "type": "text",
                "name": "clientId",
                "validations": {
                  "required": true
                }
              }
            },
            {
              "type": "Textbox",
              "parameters": {
                "label": "Client Secret",
                "placeholder": "Your client secret",
                "type": "password",
                "name": "clientSecret",
                "validations": {
                  "required": true
                }
              }
            },
            {
              "type": "InfoMessage",
              "parameters": {
                "text": "OAuth2 authentication provides secure access to your API endpoints.",
                "visible": true,
                "inline": true
              }
            }
          ]
        },
        {
          "title": "3. Enable Connector",
          "description": "Activate the Trellix Endpoint Security connector",
          "instructions": [
            {
              "type": "Markdown",
              "parameters": {
                "content": "### Connector Activation\n\nReview your configuration and enable the connector to start collecting security events."
              }
            },
            {
              "type": "ConnectionToggleButton",
              "parameters": {
                "connectLabel": "Connect Trellix Endpoint Security",
                "disconnectLabel": "Disconnect Connector",
                "name": "mainToggle"
              }
            },
            {
              "type": "Markdown",
              "parameters": {
                "content": "### Post-Connection\n\nAfter connecting, monitor the connector status in the **Data connectors** page. Data should begin appearing within 5-10 minutes."
              }
            }
          ]
        }
      ]
    }
  }
}